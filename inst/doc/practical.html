<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Practical Introduction to ExpertChoice</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Practical Introduction to ExpertChoice</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(ExpertChoice)</span></code></pre></div>
<p>The purpose of this vignette is to present a practical worked example of how to design a discrete choice experiment without blocking. It follows two examples both explained at greater lengths in the complimentary vignette titled: “Theoretical introduction to <code>ExpertChoice</code>”</p>
<div id="step-0-decide-on-what-to-test" class="section level1">
<h1>Step 0: Decide on what to test</h1>
<p>The process of choosing a design often involves iterating over steps 0 to 4. Some designs are more difficult to create than others. The Theoretical Introduction to <code>ExpertChoice</code> presents two designs which are illustrated in this practical vignette.</p>
<p>Here are some practical suggestions as to what makes a good design. 1. In general avoid attributes with only two levels. The design such as the one below suffers because it is difficult to convert from the fractional factorial of this design into an efficient choice experiment design. The lack of efficiency is not from the methods of converting, but inherit in the fact that achieving the minimal overlap when there is only two levels is difficult.</p>
</div>
<div id="step-1-construct-the-full-factorial" class="section level1">
<h1>Step 1: Construct the full factorial</h1>
<p>First load the <code>ExpertDesign</code> package into your R environment.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(ExpertChoice)</span></code></pre></div>
<p>Create a list object which specifies the name of the variables as well as their respective levels.<br />
<strong>NB: In ordinal data the levels should be integer sequential and start from 0</strong>. <strong>NB: In categorical data the levels should be integer sequential and start from 1</strong>. In an ordinal data experiment the level at 0 is always the reference point. As the proposed design above is a <span class="math inline">\(5^5\)</span> I have chosen to denote the object as <code>attr55</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>attri55 &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="dt">maker =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>),</span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="dt">technical =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>),</span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="dt">category_rarity =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>),</span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="dt">size =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>),</span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="dt">age =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a>)</span></code></pre></div>
<p>Calling the list object something like this is advantageous because you could have multiple competing designs still at this stage. The following design is <span class="math inline">\(4^4 2^1\)</span> and then denoted here as <code>attri4521</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>attri4521 &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="dt">maker =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>),</span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="dt">technical =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>),</span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="dt">category_rarity =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>),</span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="dt">size =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>),</span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="dt">age =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>),</span>
<span id="cb4-7"><a href="#cb4-7"></a>  <span class="dt">provenance =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a>)</span></code></pre></div>
<p>Create the full factorial object. Using the design specification as a suffix remains a handy way of keeping track of the design.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>ff55 &lt;-<span class="st"> </span><span class="kw">full_factorial</span>(attri55)</span></code></pre></div>
<p>The full factorial will contain many rows. The first five rows and the last five are given below:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">rbind</span>(<span class="kw">head</span>(ff55, <span class="dv">5</span>), <span class="kw">tail</span>(ff55, <span class="dv">5</span>))</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">#&gt;      maker technical category_rarity size age</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#&gt; 1        0         0               0    0   0</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#&gt; 2        1         0               0    0   0</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">#&gt; 3        2         0               0    0   0</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#&gt; 4        3         0               0    0   0</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#&gt; 5        4         0               0    0   0</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#&gt; 3121     0         4               4    4   4</span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co">#&gt; 3122     1         4               4    4   4</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">#&gt; 3123     2         4               4    4   4</span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">#&gt; 3124     3         4               4    4   4</span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co">#&gt; 3125     4         4               4    4   4</span></span></code></pre></div>
<p>Every variable in the full factorial has the standardised orthogonal contrast applied. These contrasts are very useful when evaluating the efficacy of a design. This is simply illustrative of what the contrasts look like for one of the variables:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">contrasts</span>(ff55<span class="op">$</span>maker)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">#&gt;        [,1]       [,2]       [,3] [,4]</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#&gt; 0  1.581139 -0.9128709 -0.6454972 -0.5</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">#&gt; 1  0.000000  1.8257419 -0.6454972 -0.5</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">#&gt; 2  0.000000  0.0000000  1.9364917 -0.5</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">#&gt; 3  0.000000  0.0000000  0.0000000  2.0</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">#&gt; 4 -1.581139 -0.9128709 -0.6454972 -0.5</span></span></code></pre></div>
</div>
<div id="step-2-augment-the-full-factorial" class="section level1">
<h1>Step 2: Augment the full factorial</h1>
<p>Once the full factorial is constructed it is possible to augment it with additional information. Many of these augmentations happen as attributes. This includes adding the B-matrix for main effects, an important matrix in DCE efficiency, as described by Street et al… The prefix <code>aff</code> is used to refer to the augmented (full) factorial. (You could of course name the object whatever you prefer.)</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>aff55 &lt;-<span class="st"> </span><span class="kw">augment_levels</span>(ff55)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">#&gt; Applying B mat</span></span></code></pre></div>
<p>A console log will appear stating that the processes of applying the B-matrix has started. If you do not get this message then the B-matrix cannot be added and a warning will be given. (Please open a GitHub issue if this is the case. I am not aware of instances where this should happen.) The B-matrix plays an important role in the choice efficiency of design. Below are ten random rows drawn from the augmented full factorial. Notice the additional of the <code>levels</code> column.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>aff55[<span class="kw">sample</span>(<span class="kw">nrow</span>(aff55), <span class="dv">10</span>), ]</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">#&gt;      maker technical category_rarity size age levels</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#&gt; 298      2         4               1    2   0  24120</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#&gt; 2192     1         3               2    2   3  13223</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">#&gt; 846      0         4               3    1   1  04311</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#&gt; 2561     0         2               2    0   4  02204</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt; 790      4         2               1    1   1  42111</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#&gt; 140      4         2               0    1   0  42010</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt; 610      4         1               4    4   0  41440</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt; 837      1         2               3    1   1  12311</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt; 189      3         2               2    1   0  32210</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt; 1717     1         3               3    3   2  13332</span></span></code></pre></div>
</div>
<div id="step-3-creating-a-fractional-factorial-design." class="section level1">
<h1>Step 3: Creating a fractional factorial design.</h1>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">#library(AlgDesign)</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="kw">library</span>(DoE.base)</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co"># library(DoE.MIParray)</span></span></code></pre></div>
<p>There are many ways to create a fractional factorial design. Practically speaking though two methods are designed to be flawlessly integrated into this package. These are the construction of a fractional factorial design using an orthogonal array with either the <code>DoE.MIParray</code> or <code>DoE.base</code> packages or using <span class="math inline">\(D\)</span>-optimal fractional factorial designs from the <code>AlgDesign</code> package. (The <code>AlgDesign</code> method could be better integrated. If you want to use this please open a GitHub issue. Will be sorted quickly.)</p>
<div id="orthogonal-arrays-doe.miparray-or-doe.base" class="section level2">
<h2>Orthogonal Arrays (<code>DoE.MIParray</code> or <code>DoE.base</code>)</h2>
<div id="determine-feasiability" class="section level3">
<h3>Determine feasiability</h3>
<p>The function <code>oa_feasible()</code> from the <code>DoE.base</code> package (<code>DoE.base::oa_feasible()</code>) provides many methods for determining if a particular design can be construed with <span class="math inline">\(N_D\)</span> rows. For the silver research (by Jed Stephens) it was found that the following design was feasible. It is possible to specify higher resolution designs. There are reasons why higher resolution designs could be advantageous.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Design: DF: 17, 32 OA (Resolution II), 64 OA (Resolution III)</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>nlevels &lt;-<span class="st"> </span><span class="kw">unlist</span>(purrr<span class="op">::</span><span class="kw">map</span>(ff55, <span class="cf">function</span>(x){<span class="kw">length</span>(<span class="kw">levels</span>(x))}))</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="kw">oa_feasible</span>(<span class="dv">25</span>, nlevels, <span class="dt">strength =</span> <span class="dv">2</span>)</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#&gt; no violation of necessary criteria  for strength  2  was found</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Using the <code>DoE.base</code> package it is possible to construct a 25 .</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>fractional_factorial_<span class="dv">55</span>_<span class="dv">25</span> &lt;-<span class="st"> </span><span class="kw">oa.design</span>(<span class="dt">nlevels =</span> nlevels, <span class="dt">columns =</span> <span class="st">&quot;min34&quot;</span>)</span></code></pre></div>
<p>When constructing a design using the <code>DoE.MIParray</code>… The function <code>mosek_MIParray()</code> was used to construct the example 64 run orthogonal array included with this package.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Not run because it requires time as well as some setting up if this is your first time.</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co"># See DoE.MIParray for more details.</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#fractional_factorial_55_25 &lt;- gurobi_MIParray(25, nlevels)</span></span></code></pre></div>
<p>Note how the functions in DoE use a slightly different notation to index the factors. The base is given level 1 in this package. This is not really a concern because it will be seamlessly converted shortly.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">head</span>(fractional_factorial_<span class="dv">55</span>_<span class="dv">25</span>, <span class="dv">10</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co">#&gt;    A B C D E</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">#&gt; 1  3 1 4 2 5</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co">#&gt; 2  5 1 2 3 4</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">#&gt; 3  3 2 1 5 4</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">#&gt; 4  4 1 3 5 2</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">#&gt; 5  3 5 2 4 1</span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">#&gt; 6  4 4 4 4 4</span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co">#&gt; 7  5 5 5 5 5</span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co">#&gt; 8  1 4 2 5 3</span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">#&gt; 9  1 2 3 4 5</span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co">#&gt; 10 3 3 3 3 3</span></span></code></pre></div>
</div>
</div>
<div id="d-efficient" class="section level2">
<h2>D-efficient</h2>
<p>Not yet discussed or though it should be achievable with minimal effort. If a reader wishes for this example to be completed before I have done so please open a GitHub issue and I shall happily oblige completing.</p>
</div>
</div>
<div id="step-4-searching-the-full-factorial-for-the-chosen-fractional-factorial-design" class="section level1">
<h1>Step 4: Searching the full factorial for the chosen fractional factorial design</h1>
<p>The ability to use multiple different packages to construct the fractional factorial design is ensured by this step. There can exist small differences between the different methods which require some fiddling.</p>
<p>The results of the <code>mosek_MIParray</code> function are orthogonal arrays without colnames. Hence in this instance the colnames need to be added. This design clearly needed to be made with the full factorial in mind. Hence the colnames from the <code>ff4521</code> object are appropriate. <strong>Note: the colnames from the aff4521 would include the levels column – hence avoid these…</strong></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">colnames</span>(fractional_factorial_<span class="dv">55</span>_<span class="dv">25</span>) &lt;-<span class="st"> </span><span class="kw">colnames</span>(ff55)</span>
<span id="cb15-2"><a href="#cb15-2"></a>fractional_f55_<span class="dv">25</span> &lt;-<span class="st"> </span><span class="kw">search_design</span>(ff55, fractional_factorial_<span class="dv">55</span>_<span class="dv">25</span>)</span></code></pre></div>
<p>The result is a fractional factorial design. Importantly though the fractional factorial design retains and inherits information from the full factorial such as the standardised orthogonal coding. To mark that many such attributes are held a special attribute is assigned to the object.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Check to see if the searched attribute exists on the fractional_f4521_64 object.</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="kw">attributes</span>(fractional_f55_<span class="dv">25</span>)<span class="op">$</span>searched</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Once an object is search converted it is now easy to run diagnostics.</p>
</div>
<div id="step-5-determining-the-efficacy-of-full-or-fractional-factorial-designs" class="section level1">
<h1>Step 5: Determining the efficacy of (full or fractional) factorial designs</h1>
<p>The generalised world length patterns gives a good overall summary of the design.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>DoE.base<span class="op">::</span><span class="kw">GWLP</span>(fractional_f55_<span class="dv">25</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co">#&gt;  0  1  2  3  4  5 </span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co">#&gt;  1  0  0 40 40 44</span></span></code></pre></div>
<p>From this we can tell that this fractional factorial design is resolution IV i.e. strength of 3. Hence the all main effects are estimable free of each other, but some are confounded with two-attribute interactions.</p>
<p>The function <code>fractional_factorial_efficiency</code> provides a formula based method of investigating the proposed fractional factorial design in more details. This function also includes in its list of results the GWLP so there is no need to specify it.</p>
<p>Two examples are given which follow the two examples in the associated note.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Test for main effects</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>main_effects &lt;-<span class="st"> </span><span class="kw">fractional_factorial_efficiency</span>(<span class="op">~</span><span class="st"> </span>maker <span class="op">+</span><span class="st"> </span>technical <span class="op">+</span><span class="st"> </span>category_rarity <span class="op">+</span><span class="st"> </span>size <span class="op">+</span><span class="st"> </span>age, fractional_f55_<span class="dv">25</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">#&gt; Your fractional factorial design has an A-efficiency of100%</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co">#&gt; Your fractional factorial design has a D-efficiency of100%</span></span></code></pre></div>
<p>The resultant object has the following objects:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">names</span>(main_effects)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co">#&gt; [1] &quot;X&quot;                   &quot;information_mat&quot;     &quot;inv_information_mat&quot;</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">#&gt; [4] &quot;lamda_mat&quot;           &quot;inv_diag&quot;            &quot;GWLP&quot;               </span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co">#&gt; [7] &quot;A_eff&quot;               &quot;D_eff&quot;</span></span></code></pre></div>
<p>Check the package help file for the <code>fractional_factorial_efficiency()</code> function for a full description. Also see the associated note for a more technical description.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># Test for main effects and interactions described in note.</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co">#main_plus_interacts &lt;- fractional_factorial_efficiency(~ maker * technical + category_rarity + size + age, fractional_f55_25)</span></span></code></pre></div>
<p>This design supports only a single set of two-attribute interactions i.e. maker interact technical, or size interact age or age interact provenance etc. However it does not support more than two sets of two-attribute interactions: i.e. in this instance the maker interact technical and age interact provenance.</p>
<p>In instances where some of the stipulated effects cannot be estimated (such as above) then the D-efficiency would be NaN and similarly the A-efficiency is zero.</p>
</div>
<div id="step-6-methods-to-convert-from-factorial-designs-to-discrete-choice-experiments" class="section level1">
<h1>Step 6: Methods to convert from factorial designs to discrete choice experiments</h1>
<p>In general there are a few methods for converting between fractional factorial to discrete choice experiments. The Theoretical introduction to <code>ExpertChoice</code> vignette gives more details. Although it is intended to implement the Modulo Method, <span class="math inline">\(\text{L}^{\text{MA}}\)</span>, Rotation and mix-and-match, currently only the Modulo method is implemented. Which is sensible because as methods go it creates smaller and more efficient designs than these others. Notwithstanding this, if it is of interest to implement other methods these can be included in this package with limited difficulty. Please raise a GitHub issue.</p>
<div id="modulo-method" class="section level2">
<h2>Modulo Method</h2>
<p>See the Theoretical introduction to <code>ExpertChoice</code> vignette for more details on how this method works. <!-- TODO: All the methods presented in step 6 should give a class of `choice_set`. The modulo method already has this.
!--></p>
<p>The modulators are supplied as vectors contained within a list. The number of vectors provided determines the number of choice cards within a given choice set.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>dce_modulo &lt;-<span class="st"> </span><span class="kw">modulo_method</span>(</span>
<span id="cb21-2"><a href="#cb21-2"></a>  fractional_f55_<span class="dv">25</span>,</span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb21-4"><a href="#cb21-4"></a>)</span></code></pre></div>
</div>
</div>
<div id="step-7-checking-for-pareto-overshadowed-cards" class="section level1">
<h1>Step 7: Checking for Pareto Overshadowed Cards</h1>
<p>Sometimes a particular choice may be Pareto dominate over all other choices. In such an instance there is no need to ask this question as it can be automatically answered and later augmented to the respondent data. It is important to remember to augment Pareto dominate choice sets if any exist.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>checking_overshadow &lt;-<span class="st"> </span><span class="kw">check_overshadow</span>(dce_modulo)</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co"># The matrix of indixes indicate that for row 1, 7, 13, 19 and 25 there are Pareto dominate solutions.</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>checking_overshadow</span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co">#&gt;        [,1]  [,2]</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">#&gt;  [1,]  TRUE  TRUE</span></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="co">#&gt;  [2,] FALSE FALSE</span></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="co">#&gt;  [3,] FALSE FALSE</span></span>
<span id="cb22-8"><a href="#cb22-8"></a><span class="co">#&gt;  [4,] FALSE FALSE</span></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="co">#&gt;  [5,] FALSE FALSE</span></span>
<span id="cb22-10"><a href="#cb22-10"></a><span class="co">#&gt;  [6,] FALSE FALSE</span></span>
<span id="cb22-11"><a href="#cb22-11"></a><span class="co">#&gt;  [7,]  TRUE  TRUE</span></span>
<span id="cb22-12"><a href="#cb22-12"></a><span class="co">#&gt;  [8,] FALSE FALSE</span></span>
<span id="cb22-13"><a href="#cb22-13"></a><span class="co">#&gt;  [9,] FALSE FALSE</span></span>
<span id="cb22-14"><a href="#cb22-14"></a><span class="co">#&gt; [10,] FALSE FALSE</span></span>
<span id="cb22-15"><a href="#cb22-15"></a><span class="co">#&gt; [11,] FALSE FALSE</span></span>
<span id="cb22-16"><a href="#cb22-16"></a><span class="co">#&gt; [12,] FALSE FALSE</span></span>
<span id="cb22-17"><a href="#cb22-17"></a><span class="co">#&gt; [13,]  TRUE  TRUE</span></span>
<span id="cb22-18"><a href="#cb22-18"></a><span class="co">#&gt; [14,] FALSE FALSE</span></span>
<span id="cb22-19"><a href="#cb22-19"></a><span class="co">#&gt; [15,] FALSE FALSE</span></span>
<span id="cb22-20"><a href="#cb22-20"></a><span class="co">#&gt; [16,] FALSE FALSE</span></span>
<span id="cb22-21"><a href="#cb22-21"></a><span class="co">#&gt; [17,] FALSE FALSE</span></span>
<span id="cb22-22"><a href="#cb22-22"></a><span class="co">#&gt; [18,] FALSE FALSE</span></span>
<span id="cb22-23"><a href="#cb22-23"></a><span class="co">#&gt; [19,]  TRUE  TRUE</span></span>
<span id="cb22-24"><a href="#cb22-24"></a><span class="co">#&gt; [20,] FALSE FALSE</span></span>
<span id="cb22-25"><a href="#cb22-25"></a><span class="co">#&gt; [21,] FALSE FALSE</span></span>
<span id="cb22-26"><a href="#cb22-26"></a><span class="co">#&gt; [22,] FALSE FALSE</span></span>
<span id="cb22-27"><a href="#cb22-27"></a><span class="co">#&gt; [23,] FALSE FALSE</span></span>
<span id="cb22-28"><a href="#cb22-28"></a><span class="co">#&gt; [24,] FALSE FALSE</span></span>
<span id="cb22-29"><a href="#cb22-29"></a><span class="co">#&gt; [25,]  TRUE  TRUE</span></span></code></pre></div>
</div>
<div id="step-8-efficacy-of-the-discrete-choice-design" class="section level1">
<h1>Step 8: Efficacy of the Discrete Choice Design</h1>
<p>This calculates the D-efficiency of the design as per Street, D.J., Burgess, L. and Louviere, J.J., 2005. Quick and easy choice sets: constructing optimal and nearly optimal stated choice experiments. International Journal of Research in Marketing, 22(4), pp.459-470. The pages of direct interest are 462 - 463 and these should be read in conjunction with the Theoretical introduction to <code>ExpertChoice</code> vignette. All the cases are printed and you can compare the calculation to the original paper.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>dce_modulo_efficacy &lt;-<span class="st"> </span><span class="kw">dce_efficiency</span>(aff55, dce_modulo)</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="co">#&gt; </span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co">#&gt; q is1</span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co">#&gt;   L is5</span></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="co">#&gt; Case 4</span></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="co">#&gt;   s is3</span></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co">#&gt; </span></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="co">#&gt; q is2</span></span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="co">#&gt;   L is5</span></span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="co">#&gt; Case 4</span></span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="co">#&gt;   s is3</span></span>
<span id="cb23-12"><a href="#cb23-12"></a><span class="co">#&gt; </span></span>
<span id="cb23-13"><a href="#cb23-13"></a><span class="co">#&gt; q is3</span></span>
<span id="cb23-14"><a href="#cb23-14"></a><span class="co">#&gt;   L is5</span></span>
<span id="cb23-15"><a href="#cb23-15"></a><span class="co">#&gt; Case 4</span></span>
<span id="cb23-16"><a href="#cb23-16"></a><span class="co">#&gt;   s is3</span></span>
<span id="cb23-17"><a href="#cb23-17"></a><span class="co">#&gt; </span></span>
<span id="cb23-18"><a href="#cb23-18"></a><span class="co">#&gt; q is4</span></span>
<span id="cb23-19"><a href="#cb23-19"></a><span class="co">#&gt;   L is5</span></span>
<span id="cb23-20"><a href="#cb23-20"></a><span class="co">#&gt; Case 4</span></span>
<span id="cb23-21"><a href="#cb23-21"></a><span class="co">#&gt;   s is3</span></span>
<span id="cb23-22"><a href="#cb23-22"></a><span class="co">#&gt; </span></span>
<span id="cb23-23"><a href="#cb23-23"></a><span class="co">#&gt; q is5</span></span>
<span id="cb23-24"><a href="#cb23-24"></a><span class="co">#&gt;   L is5</span></span>
<span id="cb23-25"><a href="#cb23-25"></a><span class="co">#&gt; Case 4</span></span>
<span id="cb23-26"><a href="#cb23-26"></a><span class="co">#&gt;   s is3</span></span>
<span id="cb23-27"><a href="#cb23-27"></a><span class="co">#&gt; </span></span>
<span id="cb23-28"><a href="#cb23-28"></a><span class="co">#&gt; </span></span>
<span id="cb23-29"><a href="#cb23-29"></a><span class="co">#&gt; The D-efficiency of this discrete choice experiment is98.883%</span></span></code></pre></div>
</div>
<div id="step-9-construct-a-discrete-choice-question-frame" class="section level1">
<h1>Step 9: Construct a Discrete Choice Question Frame</h1>
<p>The function <code>construct_question_frame</code> is helpful with the final stages. It consistently converts a <code>choice_set</code> arrangement into a <code>data.frame</code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>question_table_f55 &lt;-<span class="st"> </span><span class="kw">construct_question_frame</span>(aff55, dce_modulo)</span></code></pre></div>
<p>It is now time to add some useful information back to the levels. Originally these were described in Step 0, but up until this point it has been necessary to work with only integer values. (Also just imagine if you had worked with these very long names up until this point…)</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">levels</span>(question_table_f55<span class="op">$</span>maker) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;common (bottom 50% of makers)&quot;</span>, <span class="st">&quot;known to specialists (50% to 65% of makers)&quot;</span>, <span class="st">&quot;recognised (65% to 80%)&quot;</span>, <span class="st">&quot;famous (80% to 90%)&quot;</span>, <span class="st">&quot;celebrated top 10%&quot;</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="kw">levels</span>(question_table_f55<span class="op">$</span>technical) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;below average (below 50% of craftmanship)&quot;</span>, <span class="st">&quot;good (50% to 65%)&quot;</span>, <span class="st">&quot;meritorious (65% to 80%)&quot;</span>, <span class="st">&quot;distinguished (80% to 90%)&quot;</span>, <span class="st">&quot;exquisite (top 10%)&quot;</span>)</span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="kw">levels</span>(question_table_f55<span class="op">$</span>category_rarity) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;common (bottom 20%)&quot;</span>, <span class="st">&quot;uncommon (20% to 40%)&quot;</span>, <span class="st">&quot;rare (40% to 60%)&quot;</span>, <span class="st">&quot;very rare (60% to 80%)&quot;</span>, <span class="st">&quot;exceptional (top 20%)&quot;</span>)</span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="kw">levels</span>(question_table_f55<span class="op">$</span>size) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;petite: under 125g&quot;</span>, <span class="st">&quot;small: between 126g and 275g&quot;</span>, <span class="st">&quot;medium: between 276g and 600g&quot;</span>, <span class="st">&quot;large: between 601g and 1200g&quot;</span>, <span class="st">&quot;extra large: exceeds 1200g&quot;</span>)</span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="kw">levels</span>(question_table_f55<span class="op">$</span>age) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1951-present&quot;</span>, <span class="st">&quot;1951-present&quot;</span>, <span class="st">&quot;1951-present&quot;</span>, <span class="st">&quot;1951-present&quot;</span>, <span class="st">&quot;before 1800&quot;</span>)</span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="co"># View(question_table_f4521)</span></span></code></pre></div>
<p>Viola! Here is the completed question dataframe.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>question_table_f55</span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="co">#&gt; # A tibble: 75 x 8</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co">#&gt;    question choice levels maker     technical     category_rarity  size    age  </span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co">#&gt;       &lt;int&gt;  &lt;int&gt; &lt;chr&gt;  &lt;fct&gt;     &lt;fct&gt;         &lt;fct&gt;            &lt;fct&gt;   &lt;fct&gt;</span></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co">#&gt;  1        1      1 11111  known to~ good (50% to~ uncommon (20% t~ small:~ 1951~</span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="co">#&gt;  2        1      2 33333  famous (~ distinguishe~ very rare (60% ~ large:~ 1951~</span></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="co">#&gt;  3        1      3 00000  common (~ below averag~ common (bottom ~ petite~ 1951~</span></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co">#&gt;  4        2      1 33333  famous (~ distinguishe~ very rare (60% ~ large:~ 1951~</span></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="co">#&gt;  5        2      2 00000  common (~ below averag~ common (bottom ~ petite~ 1951~</span></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="co">#&gt;  6        2      3 22222  recognis~ meritorious ~ rare (40% to 60~ medium~ 1951~</span></span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="co">#&gt;  7        3      1 24130  recognis~ exquisite (t~ uncommon (20% t~ large:~ 1951~</span></span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="co">#&gt;  8        3      2 41302  celebrat~ good (50% to~ very rare (60% ~ petite~ 1951~</span></span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="co">#&gt;  9        3      3 13024  known to~ distinguishe~ common (bottom ~ medium~ befo~</span></span>
<span id="cb26-14"><a href="#cb26-14"></a><span class="co">#&gt; 10        4      1 01234  common (~ good (50% to~ rare (40% to 60~ large:~ befo~</span></span>
<span id="cb26-15"><a href="#cb26-15"></a><span class="co">#&gt; # ... with 65 more rows</span></span></code></pre></div>
</div>
<div id="the-restaurant-example" class="section level1">
<h1>The Restaurant Example</h1>
<p>This DCE construction is described in the Theory Introduction to <code>ExpertChoice</code> vignette. It is intended to show more succinctly (than the silver example above) how to design such an experiment.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co">#Step 0</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="co"># Described in Theory</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>attri3261 &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb27-4"><a href="#cb27-4"></a>  <span class="dt">starter =</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>),</span>
<span id="cb27-5"><a href="#cb27-5"></a>  <span class="dt">main =</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;6&quot;</span>),</span>
<span id="cb27-6"><a href="#cb27-6"></a>  <span class="dt">dessert =</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>)</span>
<span id="cb27-7"><a href="#cb27-7"></a>)</span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="co"># Step 1</span></span>
<span id="cb27-9"><a href="#cb27-9"></a>ff_examp &lt;-<span class="st"> </span><span class="kw">full_factorial</span>(attri3261)</span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="co"># Step 2</span></span>
<span id="cb27-11"><a href="#cb27-11"></a>aff_examp &lt;-<span class="st"> </span><span class="kw">augment_levels</span>(ff_examp)</span>
<span id="cb27-12"><a href="#cb27-12"></a><span class="co">#&gt; Applying B mat</span></span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="co">#write.csv(ff_examp, &quot;example.csv&quot;)</span></span>
<span id="cb27-14"><a href="#cb27-14"></a><span class="co"># Step 3</span></span>
<span id="cb27-15"><a href="#cb27-15"></a>nlevels &lt;-<span class="st"> </span><span class="kw">unlist</span>(purrr<span class="op">::</span><span class="kw">map</span>(ff_examp, <span class="cf">function</span>(x){<span class="kw">length</span>(<span class="kw">levels</span>(x))}))</span>
<span id="cb27-16"><a href="#cb27-16"></a><span class="co">#oa_feasible(36, nlevels, strength = 3)</span></span>
<span id="cb27-17"><a href="#cb27-17"></a></span>
<span id="cb27-18"><a href="#cb27-18"></a>fractional_factorial_<span class="dv">3261</span>_<span class="dv">18</span> &lt;-<span class="st"> </span><span class="kw">oa.design</span>(<span class="dt">nlevels =</span> nlevels, <span class="dt">columns =</span> <span class="st">&quot;min34&quot;</span>)</span>
<span id="cb27-19"><a href="#cb27-19"></a><span class="co"># The fractional_factorial design is generated using the DoE.MIParray package.</span></span>
<span id="cb27-20"><a href="#cb27-20"></a><span class="co"># The following is the command to run this generation.</span></span>
<span id="cb27-21"><a href="#cb27-21"></a><span class="co"># The result is saved in the package.</span></span>
<span id="cb27-22"><a href="#cb27-22"></a></span>
<span id="cb27-23"><a href="#cb27-23"></a></span>
<span id="cb27-24"><a href="#cb27-24"></a><span class="co"># Step 4</span></span>
<span id="cb27-25"><a href="#cb27-25"></a><span class="co"># Confirming that this is an efficient design.</span></span>
<span id="cb27-26"><a href="#cb27-26"></a><span class="kw">colnames</span>(fractional_factorial_<span class="dv">3261</span>_<span class="dv">18</span>) &lt;-<span class="st"> </span><span class="kw">colnames</span>(ff_examp)</span>
<span id="cb27-27"><a href="#cb27-27"></a>fractional_factorial_<span class="dv">3261</span>_<span class="dv">18</span> &lt;-<span class="st"> </span><span class="kw">search_design</span>(ff_examp, fractional_factorial_<span class="dv">3261</span>_<span class="dv">18</span>)</span>
<span id="cb27-28"><a href="#cb27-28"></a></span>
<span id="cb27-29"><a href="#cb27-29"></a><span class="co"># Step 5.</span></span>
<span id="cb27-30"><a href="#cb27-30"></a><span class="co"># This table is reported as Table</span></span>
<span id="cb27-31"><a href="#cb27-31"></a><span class="co"># Confirm that this design supports all interactions.</span></span>
<span id="cb27-32"><a href="#cb27-32"></a>row1_main_effects &lt;-<span class="st"> </span><span class="kw">fractional_factorial_efficiency</span>(<span class="op">~</span><span class="st"> </span>starter <span class="op">+</span><span class="st"> </span>main <span class="op">+</span><span class="st"> </span>dessert, fractional_factorial_<span class="dv">3261</span>_<span class="dv">18</span>)</span>
<span id="cb27-33"><a href="#cb27-33"></a><span class="co">#&gt; Your fractional factorial design has an A-efficiency of100%</span></span>
<span id="cb27-34"><a href="#cb27-34"></a><span class="co">#&gt; Your fractional factorial design has a D-efficiency of100%</span></span>
<span id="cb27-35"><a href="#cb27-35"></a></span>
<span id="cb27-36"><a href="#cb27-36"></a><span class="co"># Step 6.</span></span>
<span id="cb27-37"><a href="#cb27-37"></a><span class="co"># Two different card options</span></span>
<span id="cb27-38"><a href="#cb27-38"></a><span class="co"># Option 1</span></span>
<span id="cb27-39"><a href="#cb27-39"></a>dce_modulo_examp1 &lt;-<span class="st"> </span><span class="kw">modulo_method</span>(</span>
<span id="cb27-40"><a href="#cb27-40"></a>  fractional_factorial_<span class="dv">3261</span>_<span class="dv">18</span>,</span>
<span id="cb27-41"><a href="#cb27-41"></a>  <span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb27-42"><a href="#cb27-42"></a>)</span>
<span id="cb27-43"><a href="#cb27-43"></a></span>
<span id="cb27-44"><a href="#cb27-44"></a><span class="co"># Option 2.</span></span>
<span id="cb27-45"><a href="#cb27-45"></a>dce_modulo_examp2 &lt;-<span class="st"> </span><span class="kw">modulo_method</span>(</span>
<span id="cb27-46"><a href="#cb27-46"></a>  fractional_factorial_<span class="dv">3261</span>_<span class="dv">18</span>,</span>
<span id="cb27-47"><a href="#cb27-47"></a>  <span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>))</span>
<span id="cb27-48"><a href="#cb27-48"></a>)</span>
<span id="cb27-49"><a href="#cb27-49"></a></span>
<span id="cb27-50"><a href="#cb27-50"></a><span class="co"># Step 7</span></span>
<span id="cb27-51"><a href="#cb27-51"></a><span class="co"># This experiment uses categorical data (not ordinal) hence there can be no pareto dominate solution.</span></span>
<span id="cb27-52"><a href="#cb27-52"></a><span class="co"># Each category is merely a choice.</span></span>
<span id="cb27-53"><a href="#cb27-53"></a></span>
<span id="cb27-54"><a href="#cb27-54"></a></span>
<span id="cb27-55"><a href="#cb27-55"></a><span class="co"># Step 8.</span></span>
<span id="cb27-56"><a href="#cb27-56"></a><span class="co"># Compare the efficiencies.</span></span>
<span id="cb27-57"><a href="#cb27-57"></a>dce_efficency_menu_example1 &lt;-<span class="st"> </span><span class="kw">dce_efficiency</span>(aff_examp, dce_modulo_examp1)</span>
<span id="cb27-58"><a href="#cb27-58"></a><span class="co">#&gt; </span></span>
<span id="cb27-59"><a href="#cb27-59"></a><span class="co">#&gt; q is1</span></span>
<span id="cb27-60"><a href="#cb27-60"></a><span class="co">#&gt;   L is3</span></span>
<span id="cb27-61"><a href="#cb27-61"></a><span class="co">#&gt;   Case 3</span></span>
<span id="cb27-62"><a href="#cb27-62"></a><span class="co">#&gt;   The implied x is1and y is0</span></span>
<span id="cb27-63"><a href="#cb27-63"></a><span class="co">#&gt;   s is3</span></span>
<span id="cb27-64"><a href="#cb27-64"></a><span class="co">#&gt; </span></span>
<span id="cb27-65"><a href="#cb27-65"></a><span class="co">#&gt; q is2</span></span>
<span id="cb27-66"><a href="#cb27-66"></a><span class="co">#&gt;   L is6</span></span>
<span id="cb27-67"><a href="#cb27-67"></a><span class="co">#&gt; Case 4</span></span>
<span id="cb27-68"><a href="#cb27-68"></a><span class="co">#&gt;   s is3</span></span>
<span id="cb27-69"><a href="#cb27-69"></a><span class="co">#&gt; </span></span>
<span id="cb27-70"><a href="#cb27-70"></a><span class="co">#&gt; q is3</span></span>
<span id="cb27-71"><a href="#cb27-71"></a><span class="co">#&gt;   L is3</span></span>
<span id="cb27-72"><a href="#cb27-72"></a><span class="co">#&gt;   Case 3</span></span>
<span id="cb27-73"><a href="#cb27-73"></a><span class="co">#&gt;   The implied x is1and y is0</span></span>
<span id="cb27-74"><a href="#cb27-74"></a><span class="co">#&gt;   s is3</span></span>
<span id="cb27-75"><a href="#cb27-75"></a><span class="co">#&gt; </span></span>
<span id="cb27-76"><a href="#cb27-76"></a><span class="co">#&gt; </span></span>
<span id="cb27-77"><a href="#cb27-77"></a><span class="co">#&gt; The D-efficiency of this discrete choice experiment is61.038%</span></span>
<span id="cb27-78"><a href="#cb27-78"></a>dce_efficency_menu_example2 &lt;-<span class="st"> </span><span class="kw">dce_efficiency</span>(aff_examp, dce_modulo_examp2)</span>
<span id="cb27-79"><a href="#cb27-79"></a><span class="co">#&gt; </span></span>
<span id="cb27-80"><a href="#cb27-80"></a><span class="co">#&gt; q is1</span></span>
<span id="cb27-81"><a href="#cb27-81"></a><span class="co">#&gt;   L is3</span></span>
<span id="cb27-82"><a href="#cb27-82"></a><span class="co">#&gt;   Case 3</span></span>
<span id="cb27-83"><a href="#cb27-83"></a><span class="co">#&gt;   The implied x is1and y is1</span></span>
<span id="cb27-84"><a href="#cb27-84"></a><span class="co">#&gt;   s is5</span></span>
<span id="cb27-85"><a href="#cb27-85"></a><span class="co">#&gt; </span></span>
<span id="cb27-86"><a href="#cb27-86"></a><span class="co">#&gt; q is2</span></span>
<span id="cb27-87"><a href="#cb27-87"></a><span class="co">#&gt;   L is6</span></span>
<span id="cb27-88"><a href="#cb27-88"></a><span class="co">#&gt; Case 4</span></span>
<span id="cb27-89"><a href="#cb27-89"></a><span class="co">#&gt;   s is6</span></span>
<span id="cb27-90"><a href="#cb27-90"></a><span class="co">#&gt; </span></span>
<span id="cb27-91"><a href="#cb27-91"></a><span class="co">#&gt; q is3</span></span>
<span id="cb27-92"><a href="#cb27-92"></a><span class="co">#&gt;   L is3</span></span>
<span id="cb27-93"><a href="#cb27-93"></a><span class="co">#&gt;   Case 3</span></span>
<span id="cb27-94"><a href="#cb27-94"></a><span class="co">#&gt;   The implied x is1and y is1</span></span>
<span id="cb27-95"><a href="#cb27-95"></a><span class="co">#&gt;   s is5</span></span>
<span id="cb27-96"><a href="#cb27-96"></a><span class="co">#&gt; </span></span>
<span id="cb27-97"><a href="#cb27-97"></a><span class="co">#&gt; </span></span>
<span id="cb27-98"><a href="#cb27-98"></a><span class="co">#&gt; The D-efficiency of this discrete choice experiment is80.683%</span></span>
<span id="cb27-99"><a href="#cb27-99"></a><span class="co"># Option 2 is much more efficient so let&#39;s use that version!</span></span>
<span id="cb27-100"><a href="#cb27-100"></a></span>
<span id="cb27-101"><a href="#cb27-101"></a><span class="co"># Step 9</span></span>
<span id="cb27-102"><a href="#cb27-102"></a><span class="co"># Construct the question table</span></span>
<span id="cb27-103"><a href="#cb27-103"></a>menu_question_table &lt;-<span class="st"> </span><span class="kw">construct_question_frame</span>(aff_examp, dce_modulo_examp2)</span>
<span id="cb27-104"><a href="#cb27-104"></a></span>
<span id="cb27-105"><a href="#cb27-105"></a><span class="co"># Finally augment the question table. See Table 1 in the Theoretical Vignette.</span></span>
<span id="cb27-106"><a href="#cb27-106"></a><span class="kw">levels</span>(menu_question_table<span class="op">$</span>starter) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Tomato Soup&quot;</span>, <span class="st">&quot;Duck Rillettes&quot;</span>, <span class="st">&quot;Seafood Chowder&quot;</span>)</span>
<span id="cb27-107"><a href="#cb27-107"></a><span class="kw">levels</span>(menu_question_table<span class="op">$</span>main) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Roast Pheasant&quot;</span>, <span class="st">&quot;Pan Fried Hake&quot;</span>, <span class="st">&quot;Pork Belly&quot;</span>, <span class="st">&quot;Mushroom Risotto&quot;</span>, <span class="st">&quot;Sirloin Steak&quot;</span>, <span class="st">&quot;Vegetable Bake&quot;</span>)</span>
<span id="cb27-108"><a href="#cb27-108"></a><span class="kw">levels</span>(menu_question_table<span class="op">$</span>dessert) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Sticky Toffee Pudding&quot;</span>, <span class="st">&quot;Chocolate &amp; Hazelnut Brownie&quot;</span>, <span class="st">&quot;Cheesecake&quot;</span>)</span>
<span id="cb27-109"><a href="#cb27-109"></a><span class="co">#View(menu_question_table)</span></span></code></pre></div>
<p>Finally here is the resulting question table.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>menu_question_table</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="co">#&gt; # A tibble: 72 x 6</span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="co">#&gt;    question choice levels starter        main           dessert                 </span></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="co">#&gt;       &lt;int&gt;  &lt;int&gt; &lt;chr&gt;  &lt;fct&gt;          &lt;fct&gt;          &lt;fct&gt;                   </span></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="co">#&gt;  1        1      1 331    Seafood Chowd~ Pork Belly     Sticky Toffee Pudding   </span></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="co">#&gt;  2        1      2 132    Tomato Soup    Pork Belly     Chocolate &amp; Hazelnut Br~</span></span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="co">#&gt;  3        1      3 162    Tomato Soup    Vegetable Bake Chocolate &amp; Hazelnut Br~</span></span>
<span id="cb28-8"><a href="#cb28-8"></a><span class="co">#&gt;  4        1      4 321    Seafood Chowd~ Pan Fried Hake Sticky Toffee Pudding   </span></span>
<span id="cb28-9"><a href="#cb28-9"></a><span class="co">#&gt;  5        2      1 341    Seafood Chowd~ Mushroom Riso~ Sticky Toffee Pudding   </span></span>
<span id="cb28-10"><a href="#cb28-10"></a><span class="co">#&gt;  6        2      2 142    Tomato Soup    Mushroom Riso~ Chocolate &amp; Hazelnut Br~</span></span>
<span id="cb28-11"><a href="#cb28-11"></a><span class="co">#&gt;  7        2      3 112    Tomato Soup    Roast Pheasant Chocolate &amp; Hazelnut Br~</span></span>
<span id="cb28-12"><a href="#cb28-12"></a><span class="co">#&gt;  8        2      4 331    Seafood Chowd~ Pork Belly     Sticky Toffee Pudding   </span></span>
<span id="cb28-13"><a href="#cb28-13"></a><span class="co">#&gt;  9        3      1 163    Tomato Soup    Vegetable Bake Cheesecake              </span></span>
<span id="cb28-14"><a href="#cb28-14"></a><span class="co">#&gt; 10        3      2 261    Duck Rillettes Vegetable Bake Sticky Toffee Pudding   </span></span>
<span id="cb28-15"><a href="#cb28-15"></a><span class="co">#&gt; # ... with 62 more rows</span></span></code></pre></div>
</div>
<div id="replicating-the-example-in-street-et-al.-2005" class="section level1">
<h1>Replicating the example in Street <em>et al.</em>, 2005</h1>
<p>The purpose of this section is to replicate the running example in Street, D.J., Burgess, L. and Louviere, J.J., 2005. Quick and easy choice sets: constructing optimal and nearly optimal stated choice experiments. International Journal of Research in Marketing, 22(4), pp.459-470.</p>
<p>The steps commented in the code follow those of the tutorial.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># Step 0</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>atttravel &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="dt">airfaire =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>),</span>
<span id="cb29-4"><a href="#cb29-4"></a>  <span class="dt">travel_time =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>)</span>
<span id="cb29-5"><a href="#cb29-5"></a>)</span>
<span id="cb29-6"><a href="#cb29-6"></a><span class="co"># Step 1</span></span>
<span id="cb29-7"><a href="#cb29-7"></a>travel2131 &lt;-<span class="st"> </span><span class="kw">full_factorial</span>(atttravel)</span>
<span id="cb29-8"><a href="#cb29-8"></a><span class="co"># Step 2</span></span>
<span id="cb29-9"><a href="#cb29-9"></a>aff_travel2131 &lt;-<span class="st"> </span><span class="kw">augment_levels</span>(travel2131)</span>
<span id="cb29-10"><a href="#cb29-10"></a><span class="co">#&gt; Applying B mat</span></span>
<span id="cb29-11"><a href="#cb29-11"></a><span class="co"># Step 3.</span></span>
<span id="cb29-12"><a href="#cb29-12"></a><span class="co"># The full factorial is already so small that selecting a fraction of it would be silly.</span></span>
<span id="cb29-13"><a href="#cb29-13"></a><span class="co"># Therefore re-use the full factorial as the fractional factorial.</span></span>
<span id="cb29-14"><a href="#cb29-14"></a></span>
<span id="cb29-15"><a href="#cb29-15"></a><span class="co"># Step 4.</span></span>
<span id="cb29-16"><a href="#cb29-16"></a><span class="co"># Confirming that this is an efficient design.</span></span>
<span id="cb29-17"><a href="#cb29-17"></a>fractional_travel2131 &lt;-<span class="st"> </span><span class="kw">search_design</span>(travel2131, travel2131)</span>
<span id="cb29-18"><a href="#cb29-18"></a></span>
<span id="cb29-19"><a href="#cb29-19"></a><span class="co"># Step 5.</span></span>
<span id="cb29-20"><a href="#cb29-20"></a><span class="co"># Confirm that this design supports all interactions.</span></span>
<span id="cb29-21"><a href="#cb29-21"></a>full_factorial_efficiacy &lt;-<span class="st"> </span><span class="kw">fractional_factorial_efficiency</span>(<span class="op">~</span><span class="st"> </span>(airfaire <span class="op">+</span><span class="st"> </span>travel_time)<span class="op">^</span><span class="dv">2</span>, fractional_travel2131)</span>
<span id="cb29-22"><a href="#cb29-22"></a><span class="co">#&gt; Your fractional factorial design has an A-efficiency of100%</span></span>
<span id="cb29-23"><a href="#cb29-23"></a><span class="co">#&gt; Your fractional factorial design has a D-efficiency of100%</span></span>
<span id="cb29-24"><a href="#cb29-24"></a></span>
<span id="cb29-25"><a href="#cb29-25"></a><span class="co"># Step 6 &amp; Step 7.</span></span>
<span id="cb29-26"><a href="#cb29-26"></a><span class="co"># Street gives two examples of choice sets.</span></span>
<span id="cb29-27"><a href="#cb29-27"></a>travel_choice_set1 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;00&quot;</span>, <span class="st">&quot;11&quot;</span>, <span class="st">&quot;02&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;10&quot;</span>, <span class="st">&quot;02&quot;</span>, <span class="st">&quot;12&quot;</span>))</span>
<span id="cb29-28"><a href="#cb29-28"></a><span class="kw">class</span>(travel_choice_set1) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">class</span>(travel_choice_set1), <span class="st">&quot;choice_set&quot;</span>)</span>
<span id="cb29-29"><a href="#cb29-29"></a></span>
<span id="cb29-30"><a href="#cb29-30"></a>travel_example &lt;-<span class="st"> </span><span class="kw">dce_efficiency</span>(aff_travel2131, travel_choice_set1)</span>
<span id="cb29-31"><a href="#cb29-31"></a><span class="co">#&gt; </span></span>
<span id="cb29-32"><a href="#cb29-32"></a><span class="co">#&gt; q is1</span></span>
<span id="cb29-33"><a href="#cb29-33"></a><span class="co">#&gt;   L is2</span></span>
<span id="cb29-34"><a href="#cb29-34"></a><span class="co">#&gt;   Case 1</span></span>
<span id="cb29-35"><a href="#cb29-35"></a><span class="co">#&gt;   s is2</span></span>
<span id="cb29-36"><a href="#cb29-36"></a><span class="co">#&gt; </span></span>
<span id="cb29-37"><a href="#cb29-37"></a><span class="co">#&gt; q is2</span></span>
<span id="cb29-38"><a href="#cb29-38"></a><span class="co">#&gt;   L is3</span></span>
<span id="cb29-39"><a href="#cb29-39"></a><span class="co">#&gt;   Case 3</span></span>
<span id="cb29-40"><a href="#cb29-40"></a><span class="co">#&gt;   The implied x is1and y is0</span></span>
<span id="cb29-41"><a href="#cb29-41"></a><span class="co">#&gt;   s is3</span></span>
<span id="cb29-42"><a href="#cb29-42"></a><span class="co">#&gt; </span></span>
<span id="cb29-43"><a href="#cb29-43"></a><span class="co">#&gt; </span></span>
<span id="cb29-44"><a href="#cb29-44"></a><span class="co">#&gt; The D-efficiency of this discrete choice experiment is62.996%</span></span>
<span id="cb29-45"><a href="#cb29-45"></a><span class="co"># Note, if you want to rearrange the columns of the lamda matrix so that they are the same as Street use the following:</span></span>
<span id="cb29-46"><a href="#cb29-46"></a><span class="co"># lamda_street_cols  &lt;- matrix(c(travel_example$Lamda$mat[,1],</span></span>
<span id="cb29-47"><a href="#cb29-47"></a><span class="co">#                                travel_example$Lamda$mat[,3],</span></span>
<span id="cb29-48"><a href="#cb29-48"></a><span class="co">#                                travel_example$Lamda$mat[,5],</span></span>
<span id="cb29-49"><a href="#cb29-49"></a><span class="co">#                                travel_example$Lamda$mat[,2],</span></span>
<span id="cb29-50"><a href="#cb29-50"></a><span class="co">#                                travel_example$Lamda$mat[,4],</span></span>
<span id="cb29-51"><a href="#cb29-51"></a><span class="co">#                                travel_example$Lamda$mat[,6]), ncol = 6)</span></span>
<span id="cb29-52"><a href="#cb29-52"></a><span class="co"># lamda_street_paper &lt;- matrix(c(lamda_street_cols[1,],</span></span>
<span id="cb29-53"><a href="#cb29-53"></a><span class="co">#                                lamda_street_cols[3,],</span></span>
<span id="cb29-54"><a href="#cb29-54"></a><span class="co">#                                lamda_street_cols[5,],</span></span>
<span id="cb29-55"><a href="#cb29-55"></a><span class="co">#                                lamda_street_cols[2,],</span></span>
<span id="cb29-56"><a href="#cb29-56"></a><span class="co">#                                lamda_street_cols[4,],</span></span>
<span id="cb29-57"><a href="#cb29-57"></a><span class="co">#                                lamda_street_cols[6,]), ncol = 6)</span></span>
<span id="cb29-58"><a href="#cb29-58"></a><span class="co"># Street gives a second arrangement:</span></span>
<span id="cb29-59"><a href="#cb29-59"></a>travel_choice_set2 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;00&quot;</span>, <span class="st">&quot;11&quot;</span>, <span class="st">&quot;02&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;10&quot;</span>, <span class="st">&quot;01&quot;</span>, <span class="st">&quot;12&quot;</span>))</span>
<span id="cb29-60"><a href="#cb29-60"></a><span class="kw">class</span>(travel_choice_set2) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">class</span>(travel_choice_set2), <span class="st">&quot;choice_set&quot;</span>)</span>
<span id="cb29-61"><a href="#cb29-61"></a><span class="co"># This version is 100% efficient.</span></span>
<span id="cb29-62"><a href="#cb29-62"></a>travel_example2 &lt;-<span class="st"> </span><span class="kw">dce_efficiency</span>(aff_travel2131, travel_choice_set2)</span>
<span id="cb29-63"><a href="#cb29-63"></a><span class="co">#&gt; </span></span>
<span id="cb29-64"><a href="#cb29-64"></a><span class="co">#&gt; q is1</span></span>
<span id="cb29-65"><a href="#cb29-65"></a><span class="co">#&gt;   L is2</span></span>
<span id="cb29-66"><a href="#cb29-66"></a><span class="co">#&gt;   Case 1</span></span>
<span id="cb29-67"><a href="#cb29-67"></a><span class="co">#&gt;   s is2</span></span>
<span id="cb29-68"><a href="#cb29-68"></a><span class="co">#&gt; </span></span>
<span id="cb29-69"><a href="#cb29-69"></a><span class="co">#&gt; q is2</span></span>
<span id="cb29-70"><a href="#cb29-70"></a><span class="co">#&gt;   L is3</span></span>
<span id="cb29-71"><a href="#cb29-71"></a><span class="co">#&gt;   Case 3</span></span>
<span id="cb29-72"><a href="#cb29-72"></a><span class="co">#&gt;   The implied x is1and y is0</span></span>
<span id="cb29-73"><a href="#cb29-73"></a><span class="co">#&gt;   s is3</span></span>
<span id="cb29-74"><a href="#cb29-74"></a><span class="co">#&gt; </span></span>
<span id="cb29-75"><a href="#cb29-75"></a><span class="co">#&gt; </span></span>
<span id="cb29-76"><a href="#cb29-76"></a><span class="co">#&gt; The D-efficiency of this discrete choice experiment is100%</span></span>
<span id="cb29-77"><a href="#cb29-77"></a></span>
<span id="cb29-78"><a href="#cb29-78"></a><span class="co"># Step 8</span></span>
<span id="cb29-79"><a href="#cb29-79"></a>travel_questions &lt;-<span class="st"> </span><span class="kw">construct_question_frame</span>(aff_travel2131, travel_choice_set2, <span class="dt">randomise_choice_sets =</span> <span class="ot">FALSE</span>)</span>
<span id="cb29-80"><a href="#cb29-80"></a><span class="kw">levels</span>(travel_questions<span class="op">$</span>airfaire) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;$350&quot;</span>, <span class="st">&quot;$650&quot;</span>)</span>
<span id="cb29-81"><a href="#cb29-81"></a><span class="kw">levels</span>(travel_questions<span class="op">$</span>travel_time) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;4 hours&quot;</span>, <span class="st">&quot;5 hours&quot;</span>, <span class="st">&quot;6 hours&quot;</span>)</span>
<span id="cb29-82"><a href="#cb29-82"></a><span class="co">#View(travel_questions)</span></span></code></pre></div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>Street, D.J., Burgess, L. and Louviere, J.J., 2005. Quick and easy choice sets: constructing optimal and nearly optimal stated choice experiments. International Journal of Research in Marketing, 22(4), pp.459-470.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
